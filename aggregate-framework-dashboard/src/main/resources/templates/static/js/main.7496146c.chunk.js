(this["webpackJsonpaggregate-framework-web"]=this["webpackJsonpaggregate-framework-web"]||[]).push([[0],{192:function(e,t,a){e.exports=a(292)},197:function(e,t,a){},202:function(e,t,a){},292:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),l=a(26),o=a.n(l);a(197),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var i=a(55),c=a(74),m=a(25),s=(a(201),a(202),a(52)),u=a.n(s),d=a(76),f=a(21),p=a(297),g=a(178),b=a(301),E=a(299),y=a(33),h=a(31),k=a(175),v=a.n(k),x=a(186),w=v.a.create({baseURL:"",timeout:2e4});w.interceptors.request.use((function(e){if(!e.url.includes("/api/user/login")){var t=localStorage.getItem("agg-token");t&&(e.headers.Authorization=t)}return e}),(function(e){throw new Error(e)}));w.interceptors.response.use((function(e){console.log("http.interceptors.response",e);var t=null,a=e.data;return e.status&&200===e.status?401===e.status?t="\u8bf7\u5148\u767b\u5f55":a.code&&200!==a.code&&"200"!==a.code&&(t=a.code+"-"+a.message||"Error"):t="\u670d\u52a1\u5f02\u5e38\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5!",null!=t?(x.b.error(t),Promise.reject(t)):a.data}),(function(e){if(console.log("http.interceptors.response err",e),e.response){var t=e.response,a=t.data,n=void 0===a?{}:a,r=t.status,l="HTTP ERROR: ".concat(r);return"string"===typeof n?l=n:"object"===typeof n&&(l=n.message),401===r?(!function(){var e=window.location.href;localStorage.removeItem("token");var t=e.split("#")[0];window.location.href="".concat(t,"#/login")}(),x.b.error("\u8bf7\u5148\u767b\u5f55")):x.b.error(l),Promise.reject(e.response)}return x.b.error("\u670d\u52a1\u5f02\u5e38\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5!"),Promise.reject(e)}));var O=w;function j(e){return O.post("/aggregate-framework-dashboard/api/transaction/reset",{domain:e.domain,xidString:e.xidString})}function S(e){return O.post("/aggregate-framework-dashboard/api/transaction/markDeleted",{domain:e.domain,xidString:e.xidString})}function C(e){return O.post("/aggregate-framework-dashboard/api/transaction/restore",{domain:e.domain,xidString:e.xidString})}function I(e){return O.post("/aggregate-framework-dashboard/api/transaction/delete",{domain:e.domain,xidString:e.xidString})}var T=a(307),z=a(306),N=function(e){var t=e.history,a=Object(n.useState)(!1),l=Object(f.a)(a,2),o=l[0],i=l[1],c=p.a.useForm(),m=Object(f.a)(c,1)[0],s=function(){var e=Object(d.a)(u.a.mark((function e(){var a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.validateFields();case 2:a=e.sent,i(!0),(n=a,O.post("/aggregate-framework-dashboard/api/user/login",Object(h.a)({},n))).then((function(e){localStorage.setItem("agg-token",e.token),localStorage.setItem("username",e.username),localStorage.setItem("connectionMode",e.connectionMode),t.push("/welcome"),i(!1)})).catch((function(e){i(!1)}));case 5:case"end":return e.stop()}var n}),e)})));return function(){return e.apply(this,arguments)}}();return r.a.createElement("div",{className:"login-container"},r.a.createElement(g.a,{spinning:o,size:"large",delay:500},r.a.createElement(b.a,{title:"AGG\u7ba1\u7406\u540e\u53f0",style:{width:500,margin:"15rem auto"},hoverable:!0},r.a.createElement(p.a,{name:"basic",form:m,autoComplete:"off"},r.a.createElement(p.a.Item,{name:"username",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u7528\u6237\u540d!"}]},r.a.createElement(E.a,{size:"large",placeholder:"\u7528\u6237\u540d",prefix:r.a.createElement(T.a,null)})),r.a.createElement(p.a.Item,{name:"password",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u5bc6\u7801!"}]},r.a.createElement(E.a.Password,{size:"large",placeholder:"\u5bc6\u7801",prefix:r.a.createElement(z.a,null)})),r.a.createElement(p.a.Item,null,r.a.createElement(y.a,{type:"primary",htmlType:"submit",onClick:s,block:!0},"\u767b\u5f55"))))))},R=function(){return r.a.createElement("div",{style:{margin:"15rem 22rem"}},r.a.createElement("h1",{style:{fontSize:"30px"}},"\u6b22\u8fce\u6765\u5230AGG\u7ba1\u7406\u540e\u53f0"))},D=a(107),F=a(72),A=a(302),K=a(308),M=a(98),U=a(53),P=a(296),V=a(300),G=D.a.Option,q=function(e){var t=Object(n.useState)([]),a=Object(f.a)(t,2),l=a[0],o=a[1],i=Object(n.useState)(!1),c=Object(f.a)(i,2),m=c[0],s=c[1],g=Object(n.useState)(!1),b=Object(f.a)(g,2),k=b[0],v=b[1],w=Object(n.useState)(!1),j=Object(f.a)(w,2),S=j[0],C=j[1],I=Object(n.useState)(!1),T=Object(f.a)(I,2),z=T[0],N=T[1],R=p.a.useForm(),q=Object(f.a)(R,1)[0],L=p.a.useForm(),W=Object(f.a)(L,1)[0],B=function(e,t){if(e&&e.length>20){var a=String(e).substr(0,20).concat("...");return r.a.createElement("div",null,r.a.createElement(F.a,{placement:"top",title:e},r.a.createElement(y.a,null,a)))}return e},H=[{title:"domain",key:"domain",dataIndex:"domain",width:150},{title:"\u624b\u673a\u53f7",key:"phoneNumbers",dataIndex:"phoneNumbers",width:200,render:B},{title:"\u6700\u5927\u91cd\u8bd5\u6b21\u6570",key:"maxRetryCount",dataIndex:"maxRetryCount",width:200},{title:"\u544a\u8b66\u7c7b\u578b",key:"alertType",dataIndex:"alertType",width:100,render:function(e,t){return"DING"===e?"\u9489\u9489":"SMS"===e?"\u77ed\u4fe1":"PHONE"===e?"\u7535\u8bdd":"UNKONW"}},{title:"\u544a\u8b66\u9608\u503c",key:"threshold",dataIndex:"threshold",width:100},{title:"\u544a\u8b66\u95f4\u9694(\u5206\u949f)",key:"intervalMinutes",dataIndex:"intervalMinutes",width:100},{title:"\u4e0a\u6b21\u544a\u8b66\u65f6\u95f4",key:"lastAlertTime",dataIndex:"lastAlertTime",width:100},{title:"\u9489\u9489\u673a\u5668\u4eba",key:"dingRobotUrl",dataIndex:"dingRobotUrl",width:250,render:B},{title:"\u521b\u5efa\u65f6\u95f4",key:"createTime",dataIndex:"createTime",width:150},{title:"\u4fee\u6539\u65f6\u95f4",key:"lastUpdateTime",dataIndex:"lastUpdateTime",width:150},{title:"\u7248\u672c\u53f7",key:"version",dataIndex:"version",width:80},{title:"\u64cd\u4f5c",key:"operation",fixed:"right",width:180,render:function(e,t){return r.a.createElement(A.b,null,r.a.createElement(y.a,{size:"small",type:"primary",onClick:function(){$(t)}},"\u4fee\u6539"),r.a.createElement(K.a,{title:"\u662f\u5426\u6267\u884c",onConfirm:function(){Y(t)},okText:"\u662f",cancelText:"\u5426"},r.a.createElement(y.a,{size:"small",type:"primary",style:{backgroundColor:"#faad14",borderColor:"#faad14"},danger:!0},"\u544a\u8b66\u6d4b\u8bd5")),r.a.createElement(K.a,{title:"\u662f\u5426\u5220\u9664",onConfirm:function(){X(t)},okText:"\u662f",cancelText:"\u5426"},r.a.createElement(y.a,{size:"small",type:"primary",danger:!0},"\u5220\u9664")))}}];Object(n.useEffect)((function(){_()}),[]),Object(n.useEffect)((function(){W.resetFields()}),[z]);var _=function(){s(!0),O.get("/aggregate-framework-dashboard/api/domain/all").then((function(e){s(!1),o(e)})).catch((function(e){s(!1)}))},J=function(){var e=Object(d.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,q.validateFields();case 2:t=e.sent,(a=t,O.post("/aggregate-framework-dashboard/api/domain/create",Object(h.a)({},a))).then((function(e){v(!1),_()})).catch((function(e){}));case 4:case"end":return e.stop()}var a}),e)})));return function(){return e.apply(this,arguments)}}(),$=function(e){C(!0),N(Object(h.a)({},e))},Q=function(){var e=Object(d.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,W.validateFields();case 2:t=e.sent,(a=t,O.post("/aggregate-framework-dashboard/api/domain/modify",Object(h.a)({},a))).then((function(e){C(!1),_()}));case 4:case"end":return e.stop()}var a}),e)})));return function(){return e.apply(this,arguments)}}(),X=function(e){var t;(t=e,O.post("/aggregate-framework-dashboard/api/domain/delete",Object(h.a)({},t))).then((function(e){_()}))},Y=function(e){var t;(t=e,O.post("/aggregate-framework-dashboard/api/domain/alertTest",Object(h.a)({},t))).then((function(e){x.b.info("\u544a\u8b66\u6d4b\u8bd5\u6210\u529f\uff01")}))};return r.a.createElement(r.a.Fragment,null,r.a.createElement(M.a,{style:{paddingBottom:"12px",paddingRight:"12px"}},r.a.createElement(U.a,{span:1},r.a.createElement(y.a,{style:{backgroundColor:"#faad14",borderColor:"#faad14"},type:"primary",size:"small",danger:!0,onClick:function(){v(!0)}},"\u65b0\u589e")),r.a.createElement(U.a,{span:22},"\xa0"),r.a.createElement(U.a,{span:1},r.a.createElement(y.a,{type:"primary",size:"small",onClick:function(){return _()}},"\u5237\u65b0"))),r.a.createElement(P.a,{rowKey:function(e){return e.domain},columns:H,loading:m,dataSource:l,scroll:{x:2e3,y:800}}),r.a.createElement(V.a,{title:"\u65b0\u589eDomain",visible:k,getContainer:!1,forceRender:!0,closable:!1,footer:[r.a.createElement(y.a,{key:"cancel",onClick:function(){v(!1)}},"\u53d6\u6d88"),r.a.createElement(y.a,{key:"submit",type:"primary",onClick:J},"\u786e\u8ba4")]},r.a.createElement(p.a,{name:"basic",form:q,labelCol:{span:6},wrapperCol:{span:16},autoComplete:"off"},r.a.createElement(p.a.Item,{label:"domain",name:"domain",rules:[{required:!0,message:"\u8bf7\u8f93\u5165domain"}]},r.a.createElement(E.a,null)),r.a.createElement(p.a.Item,{label:"\u624b\u673a\u53f7\u5217\u8868",name:"phoneNumbers",rules:[{pattern:"[1-9][0-9]{10}(,[1-9][0-9]{10}){0,20}$",message:"\u624b\u673a\u53f7\u5217\u8868\u683c\u5f0f\u6709\u8bef\uff0c\u5f62\u5982\uff1a12345678901,12345678902"}]},r.a.createElement(E.a,null)),r.a.createElement(p.a.Item,{label:"\u6700\u5927\u91cd\u8bd5\u6b21\u6570",name:"maxRetryCount",rules:[{pattern:"[0-9]+",message:"\u5fc5\u987b\u4e3a\u6574\u6570"}]},r.a.createElement(E.a,null)),r.a.createElement(p.a.Item,{label:"\u544a\u8b66\u7c7b\u578b",initialValue:"DING",name:"alertType",rules:[{required:!0,message:"\u544a\u8b66\u7c7b\u578b\u5fc5\u586b"}]},r.a.createElement(D.a,{style:{width:80,margin:"0 8px"}},r.a.createElement(G,{value:"DING"},"\u9489\u9489"),r.a.createElement(G,{value:"SMS",disabled:!0},"\u77ed\u4fe1"),r.a.createElement(G,{value:"PHONE",disabled:!0},"\u7535\u8bdd"))),r.a.createElement(p.a.Item,{label:"\u544a\u8b66\u9608\u503c",name:"threshold",rules:[{pattern:"[0-9]+",message:"\u5fc5\u987b\u4e3a\u6574\u6570"}]},r.a.createElement(E.a,null)),r.a.createElement(p.a.Item,{label:"\u544a\u8b66\u95f4\u9694(\u5206\u949f)",name:"intervalMinutes",rules:[{pattern:"[0-9]+",message:"\u5fc5\u987b\u4e3a\u6574\u6570"}]},r.a.createElement(E.a,null)),r.a.createElement(p.a.Item,{label:"\u9489\u9489\u673a\u5668\u4eba\u5730\u5740",name:"dingRobotUrl"},r.a.createElement(E.a,null)))),r.a.createElement(V.a,{title:"\u4fee\u6539Domain",visible:S,getContainer:!1,forceRender:!0,closable:!1,footer:[r.a.createElement(y.a,{key:"cancel",onClick:function(){C(!1)}},"\u53d6\u6d88"),r.a.createElement(y.a,{key:"submit",type:"primary",onClick:Q},"\u786e\u8ba4")]},r.a.createElement(p.a,{name:"basic",form:W,labelCol:{span:6},wrapperCol:{span:16},autoComplete:"off"},r.a.createElement(p.a.Item,{label:"domain",name:"domain",initialValue:z.domain,rules:[{required:!0,message:"\u8bf7\u8f93\u5165domain"}]},r.a.createElement(E.a,{disabled:!0})),r.a.createElement(p.a.Item,{label:"\u624b\u673a\u53f7\u5217\u8868",initialValue:z.phoneNumbers,name:"phoneNumbers",rules:[{pattern:"[1-9][0-9]{10}(,[1-9][0-9]{10}){0,20}$",message:"\u624b\u673a\u53f7\u5217\u8868\u683c\u5f0f\u6709\u8bef\uff0c\u5f62\u5982\uff1a12345678901,12345678902"}]},r.a.createElement(E.a,null)),r.a.createElement(p.a.Item,{label:"\u6700\u5927\u91cd\u8bd5\u6b21\u6570",initialValue:String(z.maxRetryCount),name:"maxRetryCount",rules:[{pattern:"[0-9]+",message:"\u5fc5\u987b\u4e3a\u6574\u6570"}]},r.a.createElement(E.a,null)),r.a.createElement(p.a.Item,{label:"\u544a\u8b66\u7c7b\u578b",initialValue:z.alertType,name:"alertType",rules:[{required:!0,message:"\u544a\u8b66\u7c7b\u578b\u5fc5\u586b"}]},r.a.createElement(D.a,{style:{width:80,margin:"0 8px"}},r.a.createElement(G,{value:"DING"},"\u9489\u9489"),r.a.createElement(G,{value:"SMS",disabled:!0},"\u77ed\u4fe1"),r.a.createElement(G,{value:"PHONE",disabled:!0},"\u7535\u8bdd"))),r.a.createElement(p.a.Item,{label:"\u544a\u8b66\u9608\u503c",initialValue:String(z.threshold),name:"threshold",rules:[{pattern:"[0-9]+",message:"\u5fc5\u987b\u4e3a\u6574\u6570"}]},r.a.createElement(E.a,null)),r.a.createElement(p.a.Item,{label:"\u544a\u8b66\u95f4\u9694(\u5206\u949f)",initialValue:String(z.intervalMinutes),name:"intervalMinutes",rules:[{pattern:"[0-9]+",message:"\u5fc5\u987b\u4e3a\u6574\u6570"}]},r.a.createElement(E.a,null)),r.a.createElement(p.a.Item,{label:"\u9489\u9489\u673a\u5668\u4eba\u5730\u5740",initialValue:z.dingRobotUrl,name:"dingRobotUrl"},r.a.createElement(E.a,null)))))},L=a(152),W="UPDATE_DOMAIN_DATA",B="UPDATE_CURRENT_DOMAIN",H=function(e){var t=Object(i.c)((function(e){return e.domain})).domainData,a=Object(i.b)();return r.a.createElement("div",{className:"search-panel",style:{margin:"30px 0"}},r.a.createElement(p.a,{layout:"inline",onFinish:function(e){a({type:B,payload:e})}},r.a.createElement(p.a.Item,{label:"domain",name:"domain",initialValue:e.domain,rules:[{required:!0,message:"\u8bf7\u8f93\u5165"}]},r.a.createElement(D.a,{style:{width:400},placeholder:"\u8bf7\u9009\u62e9",showSearch:!0},t.map((function(e,t){return r.a.createElement(D.a.Option,{key:t,value:e},e)})))),r.a.createElement(p.a.Item,{label:"xid",name:"xidString"},r.a.createElement(E.a,{allowClear:!0,style:{width:400}})),r.a.createElement(p.a.Item,null,r.a.createElement(y.a,{type:"primary",htmlType:"submit"},"\u67e5\u8be2"),"\xa0\xa0\xa0")))},_=a(305),J=function(e,t){return e?String(e).split(".")[0]:e},$=[{title:"domain",dataIndex:"domain",key:"domain",width:150},{title:"xid",dataIndex:"xidString",key:"xidString",width:200,render:function(e,t){var a=e;return e&&e.length>40&&(a=String(e).substr(0,40).concat("...")),r.a.createElement("div",null,a,r.a.createElement(y.a,{className:"button",size:"small",type:"primary",style:{backgroundColor:"#03cee0",borderColor:"#03cee0"},onClick:function(){var t=document.createElement("input");t.value=e,document.body.appendChild(t),t.select(),document.execCommand("Copy"),x.b.success("\u590d\u5236\u6210\u529f"),t.remove()}},"\u590d\u5236"))}},{title:"\u5df2\u91cd\u8bd5\u6570",dataIndex:"retriedCount",key:"retriedCount",width:120},{title:"\u521b\u5efa\u65f6\u95f4",dataIndex:"createTime",key:"createTime",width:180,render:J},{title:"\u4fee\u6539\u65f6\u95f4",dataIndex:"lastUpdateTime",key:"lastUpdateTime",width:180,render:J},{title:"\u7248\u672c\u53f7",dataIndex:"version",key:"version",width:80}],Q=a(182),X=a.n(Q),Y=a(304),Z=function(e){var t=e.activeTabKey,a="deletedKeys"===t,l=Object(i.c)((function(e){return e.domain})),o=l.currentDomain,c=l.xidString,m=l.refresh,s=Object(n.useState)([]),u=Object(f.a)(s,2),d=u[0],p=u[1],g=Object(n.useState)(0),E=Object(f.a)(g,2),k=E[0],v=E[1],w=Object(n.useState)(!1),T=Object(f.a)(w,2),z=T[0],N=T[1],R=Object(n.useState)([]),D=Object(f.a)(R,2),F=D[0],M=D[1],U=Object(n.useState)([]),G=Object(f.a)(U,2),q=G[0],L=G[1],W={selectedRowKeys:q,onChange:function(e,t){console.log("selectedRows changed: ",t),M(t),L(e)}},B={offset:null,pageSize:1e3,forward:!0},H=(Object(h.a)({},B),function(){p([]),M([]),L([]),J(B)}),J=function(e){o&&(N(!0),function(e){var t=e.domain,a=e.xidString,n=e.offset,r=e.pageSize,l=e.deleted;return O.post("/aggregate-framework-dashboard/api/transaction/list",{domain:t,xidString:a,offset:n,pageSize:r,markDeleted:l})}({domain:o,xidString:c,offset:e.offset,pageSize:e.pageSize,deleted:a}).then((function(e){N(!1),p(e.items),v(e.total),e.items&&e.items.length<=0&&x.b.success("\u6ca1\u6709\u6570\u636e\u4e86\ud83d\ude01")})).catch((function(e){N(!1)})))};Object(n.useEffect)((function(){H()}),[m,t]);var Q=function(e){if(!F||F.length<=0)x.b.warn("\u8bf7\u81f3\u5c11\u9009\u62e9\u4e00\u6761\u4e8b\u4ef6");else{for(var t=new Array,a=0;a<F.length;a++)t.push(e(Object(h.a)({},F[a])));Promise.all(t).then((function(e){var t=e.length;x.b.success("\u6279\u91cf\u64cd\u4f5c\u6210\u529f"),t>0&&H()})).catch((function(e){x.b.error(e.message||"\u670d\u52a1\u5f02\u5e38\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5")}))}},Z=function(e){(function(e){var t=e.domain,a=e.xidString;return O.post("/aggregate-framework-dashboard/api/transaction/detail",{domain:t,xidString:a})})(e).then((function(e){var t,a=!0;try{console.log("contentFormat",e),t=JSON.parse(e.content)}catch(n){t=[e.content],a=!1}V.a.info({icon:!0===a?r.a.createElement(Y.a,null):r.a.createElement(Y.a,{style:{color:"red"}}),content:r.a.createElement(r.a.Fragment,null,!0===a?r.a.createElement("p",null):r.a.createElement("p",{style:{color:"red"}},"\u4e8b\u4ef6\u8be6\u60c5\u89e3\u6790\u5f02\u5e38\uff0c\u964d\u7ea7\u4e3abase64\u5c55\u793a\uff0c\u53ef\u590d\u5236\u5185\u5bb9\u53bb\u6e90\u670d\u52a1\u8fdb\u884c\u4eba\u5de5\u89e3\u6790"),r.a.createElement(X.a,{collapseStringsAfterLength:100,src:t})),width:"90%"})}))};return r.a.createElement(b.a,null,a?r.a.createElement(A.b,{size:"small",style:{float:"left",marginBottom:"1rem"}},r.a.createElement(K.a,{title:"\u662f\u5426\u6267\u884c",onConfirm:function(){return Q(C)},okText:"\u662f",cancelText:"\u5426"},r.a.createElement(y.a,{size:"small",type:"primary",style:{backgroundColor:"#faad14",borderColor:"#faad14"}},"\u6062\u590d")),r.a.createElement(K.a,{title:"\u662f\u5426\u6267\u884c",onConfirm:function(){return Q(I)},okText:"\u662f",cancelText:"\u5426"},r.a.createElement(y.a,{size:"small",type:"primary",danger:!0},"\u5f7b\u5e95\u5220\u9664"))):r.a.createElement(A.b,{size:"small",style:{float:"left",marginBottom:"1rem"}},r.a.createElement(K.a,{title:"\u662f\u5426\u6267\u884c",onConfirm:function(){return Q(j)},okText:"\u662f",cancelText:"\u5426"},r.a.createElement(y.a,{size:"small",type:"primary",style:{backgroundColor:"#faad14",borderColor:"#faad14"}},"\u91cd\u7f6e")),r.a.createElement(K.a,{title:"\u662f\u5426\u6267\u884c",onConfirm:function(){return Q(S)},okText:"\u662f",cancelText:"\u5426"},r.a.createElement(y.a,{size:"small",type:"primary",danger:!0},"\u5220\u9664"))),r.a.createElement(A.b,{size:"small",style:{float:"right"}},r.a.createElement(_.a,{color:"#f50"},"\u603b\u6570:",k>1e3?k+", \u4ec5\u663e\u793a1000\u6761":k)),r.a.createElement(P.a,{rowKey:function(e){return e.xidString},rowSelection:W,columns:$.concat({title:"\u4e8b\u4ef6\u8be6\u60c5",key:"detail",fixed:"right",width:80,render:function(e,t){return r.a.createElement(A.b,null,r.a.createElement(y.a,{className:"button",size:"small",type:"primary",onClick:function(){Z(t)}},"\u8be6\u60c5"))}}),dataSource:d,size:"small",bordered:!0,loading:z,pagination:!0,scroll:{x:1500,y:800}}))},ee=L.a.TabPane,te=function(){var e=Object(n.useState)("normal"),t=Object(f.a)(e,2),a=t[0],l=t[1],o=Object(i.c)((function(e){return e.domain})),c=o.currentDomain,m=(o.domainData,Object(i.b)()),s=function(){O.get("/aggregate-framework-dashboard/api/domain/allKeys").then((function(e){m({type:W,payload:e})}))};Object(n.useEffect)((function(){s()}),[]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(H,{domain:c}),r.a.createElement("div",{className:"content"},r.a.createElement(L.a,{defaultActiveKey:"normal",onChange:function(e){console.log("tabPane onTabChange",e,c),l(e)},activeKey:a},r.a.createElement(ee,{tab:"Normal",key:"normal"}),r.a.createElement(ee,{tab:"Deleted Keys",key:"deletedKeys"})),r.a.createElement(Z,{key:c,activeTabKey:a})))},ae=function(){var e=Object(n.useState)([]),t=Object(f.a)(e,2),a=t[0],l=t[1],o=Object(n.useState)(!1),i=Object(f.a)(o,2),c=i[0],m=i[1],s=Object(n.useState)(!1),g=Object(f.a)(s,2),b=g[0],k=g[1],v=Object(n.useState)({}),x=Object(f.a)(v,2),w=x[0],j=x[1],S=p.a.useForm(),C=Object(f.a)(S,1)[0];Object(n.useEffect)((function(){I()}),[]),Object(n.useEffect)((function(){C.resetFields()}),[w]);var I=function(){m(!0),O.get("/aggregate-framework-dashboard/api/task/all").then((function(e){m(!1),l(e)})).catch((function(e){m(!1)}))},T=[{title:"domain",dataIndex:"domain",key:"domain"},{title:"job\u7ec4",dataIndex:"jobGroup",key:"jobGroup"},{title:"job\u540d\u79f0",dataIndex:"jobName",key:"jobName"},{title:"cron\u8868\u8fbe\u5f0f",dataIndex:"cronExpression",key:"cronExpression"},{title:"\u72b6\u6001",dataIndex:"status",key:"status"},{title:"\u64cd\u4f5c",key:"operation",render:function(e,t){return r.a.createElement(A.b,null,"NORMAL"===t.status?r.a.createElement(K.a,{title:"\u662f\u5426\u6267\u884c",onConfirm:function(){var e;(e=t.domain,O.get("/aggregate-framework-dashboard/api/task/pause/"+e)).then((function(e){I()}))},okText:"\u662f",cancelText:"\u5426"},r.a.createElement(y.a,{size:"small",type:"primary",danger:!0},"\u505c\u6b62")):r.a.createElement(r.a.Fragment,null),"NORMAL"!==t.status?r.a.createElement(K.a,{title:"\u662f\u5426\u6267\u884c",onConfirm:function(){var e;(e=t.domain,O.get("/aggregate-framework-dashboard/api/task/resume/"+e)).then((function(e){I()}))},okText:"\u662f",cancelText:"\u5426"},r.a.createElement(y.a,{size:"small",type:"primary",style:{backgroundColor:"#faad14",borderColor:"#faad14"}},"\u6062\u590d")):r.a.createElement(r.a.Fragment,null),r.a.createElement(y.a,{size:"small",type:"primary",onClick:function(){z(t)}},"\u4fee\u6539"))}}],z=function(e){j(Object(h.a)({},e)),k(!0)},N=function(){var e=Object(d.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.validateFields();case 2:t=e.sent,(a=t,O.post("/aggregate-framework-dashboard/api/task/modifyCron",{domain:a.domain,cronExpression:a.cronExpression})).then((function(e){k(!1),I()})).catch((function(e){}));case 4:case"end":return e.stop()}var a}),e)})));return function(){return e.apply(this,arguments)}}();return r.a.createElement("div",null,r.a.createElement(M.a,{style:{padding:"12px"}},r.a.createElement(U.a,{span:23},"\xa0"),r.a.createElement(U.a,{span:1},r.a.createElement(y.a,{type:"primary",size:"small",onClick:function(){return I()}},"\u5237\u65b0"))),r.a.createElement(P.a,{rowKey:function(e){return e.domain},dataSource:a,columns:T,pagination:!1,loading:c}),r.a.createElement(V.a,{title:"\u4fee\u6539",visible:b,getContainer:!1,forceRender:!0,closable:!1,footer:[r.a.createElement(y.a,{key:"cancel",onClick:function(){k(!1)}},"\u53d6\u6d88"),r.a.createElement(y.a,{key:"submit",type:"primary",onClick:N},"\u786e\u8ba4")]},r.a.createElement(p.a,{name:"basic",form:C,labelCol:{span:6},wrapperCol:{span:16},onFinish:N,autoComplete:"off"},r.a.createElement(p.a.Item,{label:"domain",name:"domain",initialValue:w.domain},r.a.createElement(E.a,{disabled:!0})),r.a.createElement(p.a.Item,{label:"cron\u8868\u8fbe\u5f0f",name:"cronExpression",initialValue:w.cronExpression,rules:[{required:!0,message:"\u8bf7\u8f93\u5165cronExpression"}]},r.a.createElement(E.a,null)))))},ne=a(128),re=a(183),le={domainData:[],currentDomain:"",xidString:null,refresh:0};var oe=Object(ne.createStore)(Object(ne.combineReducers)({domain:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:le,t=arguments.length>1?arguments[1]:void 0,a=t.type,n=t.payload;switch(a){case W:return Object(h.a)(Object(h.a)({},e),{},{domainData:n});case B:return Object(h.a)(Object(h.a)({},e),{},{currentDomain:n.domain,xidString:n.xidString,refresh:e.refresh+1});default:return e}}}),Object(re.composeWithDevTools)()),ie=a(295),ce=a(82),me=a(298),se=a(131),ue=a(303),de=ie.a.Header,fe=Object(m.g)((function(e){var t=e.history,a=Object(n.useState)(!1),l=Object(f.a)(a,2),o=l[0],i=l[1],c=localStorage.getItem("username"),m=function(){localStorage.clear(),t.push("/login")},s=r.a.createElement(ce.a,{onClick:function(e){"logout"===e.key&&m(),i(!1)},theme:"dark"},r.a.createElement(ce.a.Item,{key:"logout"},"\u767b\u51fa"));return r.a.createElement(de,{style:{backgroundColor:"#001529",padding:"0px"}},r.a.createElement("span",{style:{top:"0.6rem",position:"relative",display:"inline-block"}},r.a.createElement(me.a,{width:30,preview:!1,src:"logo192.png"})),r.a.createElement("span",{style:{color:"#fff",fontSize:18,fontWeight:"bold"}},"AGG\u7ba1\u7406\u540e\u53f0"),r.a.createElement("span",{style:{float:"right"}},c?r.a.createElement(se.a,{overlay:s,onVisibleChange:function(e){i(e)},visible:o},r.a.createElement(y.a,{type:"primary",danger:!0,ghost:!0},r.a.createElement(A.b,null,c,r.a.createElement(ue.a,null)))):r.a.createElement(y.a,{onClick:function(){return console.log("toLogin"),void t.push("/login")}},"\u767b\u5f55")))})),pe=ie.a.Content,ge=ie.a.Sider,be=Object(m.g)((function(e){var t=e.history,a=e.routeList,l=Object(n.useState)(null),o=Object(f.a)(l,2),i=o[0],m=o[1],s=localStorage.getItem("connectionMode"),u=s&&"SERVER"===s.toUpperCase();return Object(n.useEffect)((function(){var e=window.location.href;console.log("app",e);var a=e.lastIndexOf("/"),n="welcome";e.endsWith("/")||(n=e.substring(a+1)),t.push("/"+n),m(n)}),[]),r.a.createElement(r.a.Fragment,null,r.a.createElement(ie.a,{className:"layout"},r.a.createElement(fe,null),r.a.createElement(ie.a,null,r.a.createElement(ge,null,r.a.createElement(ce.a,{selectedKeys:[i],defaultSelectedKeys:["welcome"],theme:"dark",onClick:function(e){m(e.key)}},r.a.createElement(ce.a.Item,{key:"welcome"},r.a.createElement(c.b,{to:"/welcome"},"\u9996\u9875")),r.a.createElement(ce.a.Item,{key:"domain"},r.a.createElement(c.b,{to:"/domain"},"Domain\u7ba1\u7406")),r.a.createElement(ce.a.Item,{key:"transaction"},r.a.createElement(c.b,{to:"/transaction"},"\u4e8b\u4ef6\u7ba1\u7406")),u?r.a.createElement(ce.a.Item,{key:"task"},r.a.createElement(c.b,{to:"/task"},"\u4efb\u52a1\u7ba1\u7406")):r.a.createElement(r.a.Fragment,null))),r.a.createElement(pe,null,r.a.createElement("div",{className:"site-layout-content"},a)))))}));var Ee=function(e){return r.a.createElement(i.a,{store:oe},r.a.createElement(c.a,{forceRefresh:!1},r.a.createElement(m.d,null,r.a.createElement(m.b,{key:"login",path:"/login",component:N}),r.a.createElement(be,{routeList:r.a.createElement(r.a.Fragment,null,r.a.createElement(m.b,{path:"/welcome",component:R}),r.a.createElement(m.b,{path:"/domain",component:q}),r.a.createElement(m.b,{path:"/transaction",component:te}),r.a.createElement(m.b,{path:"/task",component:ae}))}),r.a.createElement(m.a,{to:"/welcome",from:"/"}))))};o.a.render(r.a.createElement(Ee,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[192,1,2]]]);
//# sourceMappingURL=main.7496146c.chunk.js.map